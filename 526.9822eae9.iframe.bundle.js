"use strict";(self.webpackChunk_mykeels_mee_karaoke=self.webpackChunk_mykeels_mee_karaoke||[]).push([[526,745],{"./src/bootstrap.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__);__webpack_require__("./src/index.css");var react=__webpack_require__("./node_modules/react/index.js"),client=__webpack_require__("./node_modules/react-dom/client.js"),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),regeneratorRuntime=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),SongUploader=__webpack_require__("./src/components/SongUploader/index.js"),SongCreator=__webpack_require__("./src/components/SongCreator/index.js"),TitleCreator=__webpack_require__("./src/components/TitleCreator/index.js"),SavedFileUploader=__webpack_require__("./src/components/SavedFileUploader/index.js"),components_LyricsTabView=__webpack_require__("./src/components/SongCreator/components/LyricsTabView/index.js"),SongPicker=__webpack_require__("./src/components/SongPicker/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),process=__webpack_require__("./node_modules/process/browser.js");function getSongFileContents(_x){return _getSongFileContents.apply(this,arguments)}function _getSongFileContents(){return(_getSongFileContents=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee2(record){var apiRoot,song;return(0,regeneratorRuntime.Z)().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return apiRoot=process.env.REACT_APP_API_ROOT,_context2.next=3,fetch(record.songFilePath.replace("~",apiRoot)).then((function(res){return res.json()}));case 3:return(song=_context2.sent).song=song.lines||song.song,_context2.next=7,getAudioUrl(record);case 7:return song.audioUrl=_context2.sent,song.lyrics=song.song.map((function(l){return l.text})).join("\n"),song.id=record.id,_context2.abrupt("return",song);case 11:case"end":return _context2.stop()}}),_callee2)})))).apply(this,arguments)}function getAudioUrl(_x2){return _getAudioUrl.apply(this,arguments)}function _getAudioUrl(){return(_getAudioUrl=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee3(record){var apiRoot;return(0,regeneratorRuntime.Z)().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return apiRoot=process.env.REACT_APP_API_ROOT,_context3.abrupt("return",fetch(record.audioFilePath.replace("~",apiRoot)).then((function(res){return res.blob()})).then((function(blob){return URL.createObjectURL(blob)})));case 2:case"end":return _context3.stop()}}),_callee3)})))).apply(this,arguments)}function _saveSongFileContents(){return(_saveSongFileContents=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee4(content){var apiRoot,record;return(0,regeneratorRuntime.Z)().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(apiRoot=process.env.REACT_APP_API_ROOT,!content.id){_context4.next=6;break}return _context4.next=4,fetch("".concat(apiRoot,"/Songs/").concat(content.id),{method:"put",headers:{"Content-Type":"application/json"},body:JSON.stringify({Title:content.title,Id:content.id})}).then((function(res){return res.json()}));case 4:_context4.next=10;break;case 6:return _context4.next=8,fetch("".concat(apiRoot,"/Songs"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({Title:content.title})}).then((function(res){return res.json()}));case 8:record=_context4.sent,content.id=record.id;case 10:return _context4.next=12,uploadSongFileContent(content);case 12:return _context4.next=14,uploadAudioFile(content);case 14:return _context4.abrupt("return",content);case 15:case"end":return _context4.stop()}}),_callee4)})))).apply(this,arguments)}function uploadSongFileContent(_x4){return _uploadSongFileContent.apply(this,arguments)}function _uploadSongFileContent(){return(_uploadSongFileContent=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee5(content){var apiRoot,str,blob,formData;return(0,regeneratorRuntime.Z)().wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return apiRoot=process.env.REACT_APP_API_ROOT,str=JSON.stringify((0,objectSpread2.Z)((0,objectSpread2.Z)({},content),{},{audioUrl:"~/Static/".concat(null==content?void 0:content.id,"/audio.mp3")})),blob=new Blob([str],{type:"application/json"}),(formData=new FormData).append("files",blob),_context5.next=7,fetch("".concat(apiRoot,"/Songs/").concat(content.id,"/Files"),{method:"post",body:formData});case 7:case"end":return _context5.stop()}}),_callee5)})))).apply(this,arguments)}function uploadAudioFile(_x5){return _uploadAudioFile.apply(this,arguments)}function _uploadAudioFile(){return(_uploadAudioFile=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee6(content){var apiRoot,blob,formData;return(0,regeneratorRuntime.Z)().wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return apiRoot=process.env.REACT_APP_API_ROOT,_context6.next=3,fetch(content.audioUrl).then((function(res){return res.blob()}));case 3:return blob=_context6.sent,(formData=new FormData).append("files",blob),_context6.next=8,fetch("".concat(apiRoot,"/Songs/").concat(content.id,"/Audio-Files.mp3"),{method:"post",body:formData});case 8:case"end":return _context6.stop()}}),_callee6)})))).apply(this,arguments)}var App=function App(){var _useState=(0,react.useState)(0),_useState2=(0,slicedToArray.Z)(_useState,2),stage=_useState2[0],setStage=_useState2[1],_useState3=(0,react.useState)(null),_useState4=(0,slicedToArray.Z)(_useState3,2),state=_useState4[0],setState=_useState4[1],_useState5=(0,react.useState)(!1),_useState6=(0,slicedToArray.Z)(_useState5,2),isFileUploadActive=_useState6[0],setIsFileUploadActive=_useState6[1],selectSong=function(){var _ref=(0,asyncToGenerator.Z)((0,regeneratorRuntime.Z)().mark((function _callee(record){var song;return(0,regeneratorRuntime.Z)().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,getSongFileContents(record);case 2:song=_context.sent,setState(song),setStage(3);case 5:case"end":return _context.stop()}}),_callee)})));return function selectSong(_x6){return _ref.apply(this,arguments)}}();return(0,jsx_runtime.jsxs)("div",{className:"block overflow-auto custom-scroller h-screen",onDragEnter:function onDragEnter(e){e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?setIsFileUploadActive(!0):"dragleave"===e.type&&setIsFileUploadActive(!1)},onDrop:function onDrop(){},children:[isFileUploadActive?(0,jsx_runtime.jsx)(SavedFileUploader.L,{className:"fixed top-0 left-0 z-10",open:isFileUploadActive,onKaraokeFileReceived:function onKaraokeFileReceived(karaoke){setIsFileUploadActive(!1),setState((0,objectSpread2.Z)((0,objectSpread2.Z)((0,objectSpread2.Z)({},state),karaoke),{},{audioUrl:null,title:karaoke.title||"karaoke",lyrics:karaoke.song.map((function(l){return l.text})).join("\n")})),setStage(2)},onDragLeave:function onDragLeave(e){e.preventDefault(),e.stopPropagation(),setIsFileUploadActive(!1)}}):null,0===stage?(0,jsx_runtime.jsx)(SongPicker.o,{onNewSong:function onNewSong(){return setStage(stage+1)},onSelectSong:selectSong}):1===stage?(0,jsx_runtime.jsx)(TitleCreator.F,{onFileUploadIntent:function onFileUploadIntent(){return setIsFileUploadActive("open")},onTitleChanged:function onTitleChanged(data){setState((function(state){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},state),data)})),setStage(stage+1)}}):2===stage?(0,jsx_runtime.jsx)(SongUploader.n,{onAudioFileReceived:function onAudioFileReceived(audioUrl){setState((function(state){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},state),{},{audioUrl:audioUrl})})),setStage(stage+1)}}):(0,jsx_runtime.jsx)(SongCreator.h,{title:state.title,url:state.audioUrl,onReset:function onReset(){setState(null),setStage(0)},defaults:{song:null==state?void 0:state.song,images:null==state?void 0:state.images},LyricsTabView:function LyricsTabView(props){return(0,jsx_runtime.jsx)(components_LyricsTabView.x,(0,objectSpread2.Z)((0,objectSpread2.Z)({},props),{},{defaults:{active:"pretty",text:state.lyrics}}))},onSave:function onSave(content){return content.id=null==state?void 0:state.id,function saveSongFileContents(_x3){return _saveSongFileContents.apply(this,arguments)}((0,objectSpread2.Z)((0,objectSpread2.Z)({},content),{},{id:null==state?void 0:state.id,audioUrl:null==state?void 0:state.audioUrl,lyrics:""})).then((function(content){return setState((0,objectSpread2.Z)((0,objectSpread2.Z)({},state),{},{id:content.id}))}))}})]})};App.__docgenInfo={description:"@type {React.FC<{}>}",methods:[],displayName:"App"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/App.js"]={name:"App",docgenInfo:App.__docgenInfo,path:"src/App.js"});var src_reportWebVitals=function reportWebVitals(onPerfEntry){onPerfEntry&&onPerfEntry instanceof Function&&__webpack_require__.e(131).then(__webpack_require__.bind(__webpack_require__,"./node_modules/web-vitals/dist/web-vitals.js")).then((function(_ref){var getCLS=_ref.getCLS,getFID=_ref.getFID,getFCP=_ref.getFCP,getLCP=_ref.getLCP,getTTFB=_ref.getTTFB;getCLS(onPerfEntry),getFID(onPerfEntry),getFCP(onPerfEntry),getLCP(onPerfEntry),getTTFB(onPerfEntry)}))},es=__webpack_require__("./node_modules/react-query/es/index.js"),queryClient=new es.QueryClient;client.createRoot(document.getElementById("root")).render((0,jsx_runtime.jsx)(react.StrictMode,{children:(0,jsx_runtime.jsx)(es.QueryClientProvider,{client:queryClient,children:(0,jsx_runtime.jsx)(App,{})})})),src_reportWebVitals()},"./node_modules/react-dom/client.js":function(__unused_webpack_module,exports,__webpack_require__){var m=__webpack_require__("./node_modules/react-dom/index.js");exports.createRoot=m.createRoot,exports.hydrateRoot=m.hydrateRoot}}]);